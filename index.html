<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown to Dinda's Birthday (Turning {{age}} years old!)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var app = new Vue({
                el: "#app",
                data: {
                    title: "",
                    days: "",
                    hours: "",
                    minutes: "",
                    seconds: "",
                },
                methods: {
                    countdown: function () {
                        const second = 1000;
                        const minute = second * 60;
                        const hour = minute * 60;
                        const day = hour * 24;
                        let that = this;

                        function getAge(date) {
                            const today = new Date();
                            let age = today.getFullYear() - date.getFullYear();
                            const m = today.getMonth() - date.getMonth();
                            if (m < 0 || (m === 0 && today.getDate() < date.getDate())) {
                                age--;
                            }
                            return age;
                        }

                        let date = new Date();
                        let current = date.getTime();
                        let thisYear = date.getFullYear();
                        let bod = new Date("December 5, " + thisYear);
                        let year = (bod - current) / day < 0 ? thisYear + 1 : thisYear;
                        let countDown = new Date("December 5, " + year).getTime();

                        this.title = `Countdown to Dinda's Birthday (Turning ${getAge(new Date('2002-12-05'))} years old!)`;

                        setInterval(function () {
                            let now = new Date().getTime();
                            let distance = countDown - now;

                            that.days = Math.floor(distance / day);
                            that.hours = Math.floor((distance % day) / hour);
                            that.minutes = Math.floor((distance % hour) / minute);
                            that.seconds = Math.floor((distance % minute) / second);
                        }, second);
                    },
                },
                beforeMount() {
                    this.countdown();
                },
            });
        });
    </script>
</head>
<body>
    <div id="app">
        <h1>{{title}}</h1>
        <ul>
            <li><span>{{days}}</span> days</li>
            <li><span>{{hours}}</span> hours</li>
            <li><span>{{minutes}}</span> minutes</li>
            <li><span>{{seconds}}</span> seconds</li>
        </ul>
    </div>
</body>
</html>
